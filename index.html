<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Paper-a-Day — Home</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tailwind theme customizations (optional)
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Hind Siliguri', 'ui-sans-serif', 'system-ui', '-apple-system', 'Segoe UI', 'Roboto', 'Noto Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', 'Arial', 'sans-serif']
          },
          colors: {
            brand: {
              50: '#f5f7ff',
              100: '#e6eeff',
              600: '#4338ca',
              500: '#4f46e5',
              700: '#3730a3'
            }
          }
        }
      }
    }
  </script>
</head>
<body class="bg-white text-gray-900 font-sans antialiased">
  <header class="sticky top-0 z-10 bg-white/95 border-b">
    <div class="max-w-3xl mx-auto px-5 py-3 flex items-center justify-between">
      <a href="index.html" class="text-2xl font-extrabold tracking-tight text-gray-900">A Paper A Day</a>
      <nav class="text-sm text-gray-600">
        <a href="index.html" class="mr-4 hover:underline">Home</a>
      </nav>
    </div>
  </header>

  <main class="max-w-3xl mx-auto px-5 py-10">
    <section class="mb-8">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
        <div class="flex items-center gap-3 w-full">
          <label class="sr-only" for="search">Search posts</label>
          <div class="relative flex-1">
            <svg class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>
            <input id="search" type="search" placeholder="Search by title, excerpt or tags..." class="w-full pl-10 pr-4 py-2.5 rounded-md border border-slate-200 focus:outline-none focus:ring-1 focus:ring-gray-900/10" />
          </div>
          <select id="sort" class="px-3 py-2 rounded-md border border-slate-200 bg-white text-sm hover:bg-slate-50">
            <option value="newest">Newest</option>
            <option value="oldest">Oldest</option>
            <option value="title-asc">Title A → Z</option>
            <option value="title-desc">Title Z → A</option>
          </select>
        </div>
      </div>
      <div class="mt-3 text-xs text-slate-500">Showing <span id="count">0</span> posts</div>
    </section>

    <section id="posts" class="divide-y divide-slate-200">
      <!-- Posts will be rendered here -->
    </section>

    <div id="no-results" class="hidden text-center text-gray-500 mt-8">No posts found.</div>
  </main>

  <footer class="mt-20 border-t bg-white">
    <div class="max-w-3xl mx-auto px-5 py-6 text-sm text-gray-500">Built with Tailwind • Static demo</div>
  </footer>

  <script src="data.js"></script>
  <script>
    // Basic client-side rendering logic
    const postsContainer = document.getElementById('posts');
    const searchInput = document.getElementById('search');
    const sortSelect = document.getElementById('sort');
  const noResults = document.getElementById('no-results');
  const countEl = document.getElementById('count');

    // Defensive: posts should be defined in data.js
    if (!Array.isArray(window.posts)) {
      postsContainer.innerHTML = '<div class="p-6 bg-red-50 border border-red-100 text-red-800 rounded">Missing <code>data.js</code> or `window.posts` array.</div>';
    }

    let filtered = [...(window.posts || [])];

    function formatDate(iso) {
      try {
        const d = new Date(iso);
        return d.toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: 'numeric' });
      } catch (e) {
        return iso;
      }
    }

    function render() {
      const list = filtered;
      postsContainer.innerHTML = '';
      if (!list.length) {
        noResults.classList.remove('hidden');
        if (countEl) countEl.textContent = '0';
        return;
      }
      noResults.classList.add('hidden');
      if (countEl) countEl.textContent = String(list.length);

      for (const p of list) {
        const el = document.createElement('article');
        el.className = 'py-8';
        el.innerHTML = `
          ${p.image ? `<a href="post.html?id=${encodeURIComponent(p.id)}" class="group block"><img src="${escapeHtml(p.image)}" alt="${escapeHtml(p.title)}" class="w-full aspect-video object-cover rounded-lg mb-4 group-hover:opacity-90 transition-opacity"></a>` : ''}
          <a href="post.html?id=${encodeURIComponent(p.id)}" class="group inline-block">
            <h2 class="text-2xl sm:text-3xl font-extrabold tracking-tight text-gray-900 group-hover:underline">${escapeHtml(p.title)}</h2>
          </a>
          <div class="mt-2 text-sm text-gray-500 flex items-center gap-2">
            <time>${formatDate(p.date)}</time>
            <span>·</span>
            <span>${readingTime(p)}</span>
            <span>·</span>
            <span>By ${escapeHtml(window.author.name)}</span>
          </div>
          <p class="mt-3 text-base text-gray-700">${escapeHtml(p.excerpt)}</p>
          ${Array.isArray(p.tags) && p.tags.length ? `
            <div class="mt-4 flex flex-wrap gap-2">
              ${p.tags.slice(0,5).map(t => `<span class="text-xs bg-slate-100 text-slate-700 px-2.5 py-1 rounded-full border">${escapeHtml(t)}</span>`).join('')}
            </div>
          ` : ''}
        `;
        postsContainer.appendChild(el);
      }
    }

    function escapeHtml(str) {
      if (!str && str !== 0) return '';
      return String(str)
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
    }

    function applyFilters() {
      const q = searchInput.value.trim().toLowerCase();
      filtered = (window.posts || []).filter(p => {
        if (!q) return true;
        const hay = (p.title + ' ' + (p.excerpt||'') + ' ' + (p.tags||[]).join(' ')).toLowerCase();
        return hay.includes(q);
      });

      const sort = sortSelect.value;
      filtered.sort((a,b) => {
        if (sort === 'newest') return new Date(b.date) - new Date(a.date);
        if (sort === 'oldest') return new Date(a.date) - new Date(b.date);
        if (sort === 'title-asc') return a.title.localeCompare(b.title);
        if (sort === 'title-desc') return b.title.localeCompare(a.title);
        return 0;
      });

      render();
    }

    // debounce helper
    function debounce(fn,wait=200){
      let t; return (...args)=>{ clearTimeout(t); t=setTimeout(()=>fn(...args),wait); };
    }

    function readingTime(p){
      const text = (p && p.post) ? String(p.post) : String(p.excerpt||'');
      const words = (text.match(/\S+/g)||[]).length;
      const mins = Math.max(1, Math.round(words/200));
      return `${mins} min read`;
    }

    // init
    applyFilters();

    searchInput.addEventListener('input', debounce(applyFilters, 200));
    sortSelect.addEventListener('change', applyFilters);
  </script>
</body>
</html>